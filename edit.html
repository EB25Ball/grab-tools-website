<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Level JSON Editor | Grab Tools | twhlynch </title>
    <link rel="stylesheet" href="style.css">
    <!-- favicon gif -->
    <link rel="icon" href="spindex-small.gif" type="image/gif">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BDS57RBQ3Q"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-BDS57RBQ3Q');
    </script>
    <script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>
    <script type="importmap">
        {
          "imports": {
            "three": "https://unpkg.com/three@0.145.0/build/three.module.js"
          }
        }
    </script>
</head>
<body>
    <img src="spindex-small.gif" alt="" id="spindex">
    <div class="title">Level JSON Editor
        <a href="index.html" class="home"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
        </svg></a>
    </div>
    <div class="file-selectors">
        <label for="file" id="file-custom">Choose Level!
            <div id="file-display"></div>
        </label>
        <input type="file" name="file" id="file" accept=".level">
        <label for="file" id="file-custom-a">Choose Animated Level!
            <div id="file-display-a"></div>
        </label>
        <input type="file" name="file" id="file-a" accept=".level">
        <label for="file" id="file-custom-append">Append level!
            <div id="file-display-append"></div>
        </label>
        <input type="file" name="file" id="file-append" accept=".level">
    </div>
    <p id="selected-file">Find .levels in <code>Android/data/com.slindev.grab_demo/levels/user</code> on your Quest headset!</p>
    <div id="buttons">
        <button id="download">Download</button>
        <button id="copy">Copy JSON</button>
    </div>
    <div class="editing">
        <textarea type="text" id="out"></textarea>
        <div class="leg">
            <h3>shape</h3>
            <ul>
                <li>1000:CUBE</li>
                <li>1001:SPHERE</li>
                <li>1002:CYLINDER</li>
                <li>1003:PYRAMID</li>
                <li>1004:PRISM</li>
            </ul>
            <h3>type/material</h3>
            <ul>
                <li>0:DEFAULT</li>
                <li>1:GRABBABLE</li>
                <li>2:ICE</li>
                <li>3:LAVA</li>
                <li>4:WOOD</li>
                <li>5:GRAPPLABLE</li>
                <li>6:GRAPPLABLE_LAVA</li>
                <li>7:GRABBABLE_CRUMBLING</li>
                <li>8:DEFAULT_COLORED</li>
                <li>9:BOUNCING</li>
            </ul>
        </div>
    </div>
    <div class="tools-wrapper">
        <div class="template-wrapper">
            <h3>Templates</h3>
            <div id="templates">
                <input type="submit" id="temp-static" value="static">
                <input type="submit" id="temp-crumbling" value="crumbling">
                <input type="submit" id="temp-colored" value="colored">
                <input type="submit" id="temp-sign" value="sign">
                <input type="submit" id="temp-start" value="start">
                <input type="submit" id="temp-finish" value="finish">
            </div>
            <textarea type="text" id="template">
{
    "levelNodeStatic": {
        "shape": 1000,
        "material": 0,
        "position": {
            "x": 0,
            "y": 0,
            "z": 0
        },
        "scale": {
            "x": 1,
            "y": 1,
            "z": 1
        },
        "rotation": {
            "w": 1,
            "x": 0,
            "y": 0,
            "z": 0
        }
    }
}
            </textarea>
            <input type="submit" id="add-template" value="Append">
        </div>
        <div id="functions">
            <h3>Functions</h3>
            <div class="functions-main">
                <div class="function" id="function-title">
                    <input type="text" maxlength="80" 
                        name="title-function" 
                        id="title-function" 
                        placeholder="Set Title (80)">
                    <input type="submit" value="Run"></input>
                </div>
                <div class="function" id="function-creators">
                    <input type="text" maxlength="80"
                        name="creators-function" 
                        id="creators-function" 
                        placeholder="Set Creators (80)">
                    <input type="submit" value="Run"></input>
                </div>
                <div class="function" id="function-description">
                    <input type="text" max-length="300"
                        name="description-function" 
                        id="description-function" 
                        placeholder="Set Description (300)">
                    <input type="submit" value="Run"></input>
                </div>
                <div class="function" id="function-checkpoints">
                    <input type="number" max="32767"
                        name="checkpoints-function" 
                        id="checkpoints-function" 
                        placeholder="Set Checkpoints (32767)">
                    <input type="submit" value="Run"></input>
                </div>
                <!-- <div class="function" id="function-stretched-sign">
                    <input type="text"
                        name="stretched-sign-function" 
                        id="stretched-sign-function" 
                        placeholder="Stretched Sign (text)">
                    <input type="submit" value="Add"></input>
                </div> -->
                <div class="function" id="function-custom-color">
                    <input type="text"
                        name="custom-color-function" 
                        id="custom-color-function" 
                        placeholder="Custom Color (255,255,255)">
                    <input type="submit" value="Add"></input>
                </div>
            </div>
            <div class="preset-functions">
                <input type="submit" id="max-ambience" value="Max Ambience"></input>
                <input type="submit" id="reset-ambience" value="Reset Ambience"></input>
                <input type="submit" id="clear-info" value="Clear Info"></input>
                <input type="submit" id="add-colors" value="Unobtainable Colors"></input>
                <input type="submit" id="add-crumbling" value="Unobtainable Crumbling"></input>
                <input type="submit" id="add-sf" value="Unobtainable Start/Finish"></input>
                <!-- <input type="submit" id="add-inverted" value="Inverted Nodes"></input> -->
                <input type="submit" id="group-all" value="Group All"></input>
                <!-- <input type="submit" id="ungroup-all" value="Ungroup All"></input> -->
                <input type="submit" id="load-empty" value="Load Empty"></input>
                <input type="submit" id="randomize" value="Randomize"></input>
                <input type="submit" id="duplicate" value="Duplicate"></input>
                <input type="submit" id="parallelograms" value="Parallelograms"></input>
            </div>
        </div>
    </div>
    <div id="visual">
        <button id="refresh">refresh</button>
        <button id="goto-start">goto start</button>
        <p id="complexity">Complexity: 0</p>
    </div>
    <div class="gap"></div>
    <footer>Developed by&nbsp;&bull;&nbsp;.index&nbsp;&bull;&nbsp;<a href="https://github.com/twhlynch">@twhlynch</a>&nbsp;&bull;&nbsp;<a href="https://twhlynch.me">twhlynch.me</a></footer>
    <script src="//cdn.jsdelivr.net/npm/protobufjs@7.X.X/dist/protobuf.js"></script>
    <script type="text/javascript">

        function readArrayBuffer(file) {
            return new Promise(function(resolve, reject) {
                let reader = new FileReader();
                reader.onload = function() {
                    let data = reader.result;
                    protobuf.load("proto/level.proto", function(err, root) {
                        if(err) throw err;
                        let message = root.lookupType("COD.Level.Level");
                        let decoded = message.decode(new Uint8Array(data));
                        let object = message.toObject(decoded);
                        resolve(object);
                    });
                }
                reader.onerror = function() {
                    reject(reader);
                }
                reader.readAsArrayBuffer(file);
            });
        }

        function readAnimatedArrayBuffer(file) {
            return new Promise(function(resolve, reject) {
                let reader = new FileReader();
                reader.onload = function() {
                    let data = reader.result;
                    protobuf.load("proto-anim/level.proto", function(err, root) {
                        if(err) throw err;
                        let message = root.lookupType("COD.Level.Level");
                        let decoded = message.decode(new Uint8Array(data));
                        let object = message.toObject(decoded);
                        resolve(object);
                    });
                }
                reader.onerror = function() {
                    reject(reader);
                }
                reader.readAsArrayBuffer(file);
            });
        }

        function appendFile(e, anim=false) {
            let files = e.target.files;
            let readers = [];

            if (!files.length) return;

            for (let i = 0; i < files.length; i++) {
                let p = document.createElement('p');
                p.innerText = files[i].name;
                if (anim) {
                    readers.push(readAnimatedArrayBuffer(files[i]));
                } else {
                    readers.push(readArrayBuffer(files[i]));
                }
            }

            Promise.all(readers).then((values) => {
                obj = JSON.parse(document.getElementById('out').value);
                obj.levelNodes += values.levelNodes;
                document.getElementById('out').value = JSON.stringify(obj, null, 4);
            });

        }

        function loadFile(e, anim=false) {
            let files = e.target.files;
            let readers = [];

            if (!files.length) return;

            for (let i = 0; i < files.length; i++) {
                let p = document.createElement('p');
                p.innerText = files[i].name;
                document.getElementById('selected-file').innerHTML = p.outerHTML;
                if (anim) {
                    readers.push(readAnimatedArrayBuffer(files[i]));
                } else {
                    readers.push(readArrayBuffer(files[i]));
                }
            }

            Promise.all(readers).then((values) => {
                credited = values[0];
                if(credited.hasOwnProperty('description')){
                    if (!credited.description.includes(".index - level modding")) {
                        credited["description"] += "  .index - level modding";
                    }
                } else {
                    credited["description"] = ".index - level modding";
                }
                document.getElementById('out').value = JSON.stringify(credited, null, 4);
                document.getElementById('out').style.display = "block";
                document.getElementsByClassName('leg')[0].style.display = "flex";
            });

        }
        document.getElementById('download').addEventListener("click", function () {
            obj = JSON.parse(document.getElementById('out').value);
            protobuf.load("proto/level.proto", function(err, root) {
                if(err) throw err;

                let message = root.lookupType("COD.Level.Level");
                let errMsg = message.verify(obj);
                if(errMsg) throw Error(errMsg);
                let buffer = message.encode(message.fromObject(obj)).finish();
                
                let blob = new Blob([buffer], {type: "application/octet-stream"});

                let link = document.createElement("a");
                link.href = window.URL.createObjectURL(blob);
                link.download = (Date.now()).toString().slice(0, -3)+".level";
                link.click();
            });
        }, false);

        document.getElementById("copy").addEventListener('click', function () {
            navigator.clipboard.writeText(document.getElementById('out').value);
        }, false);
    

        document.querySelector('#function-title input[type="submit"]').addEventListener('click', function () {
            var input = document.getElementById('title-function');
            obj = JSON.parse(document.getElementById('out').value);
            obj.title = input.value;
            document.getElementById('out').value = JSON.stringify(obj, null, 4);
        });

        document.querySelector('#function-creators input[type="submit"]').addEventListener('click', function () {
            var input = document.getElementById('creators-function');
            obj = JSON.parse(document.getElementById('out').value);
            obj.creators = input.value;
            document.getElementById('out').value = JSON.stringify(obj, null, 4);
        });

        document.querySelector('#function-description input[type="submit"]').addEventListener('click', function () {
            var input = document.getElementById('description-function');
            obj = JSON.parse(document.getElementById('out').value);
            obj.description = input.value;
            document.getElementById('out').value = JSON.stringify(obj, null, 4);
        });

        document.querySelector('#function-checkpoints input[type="submit"]').addEventListener('click', function () {
            var input = document.getElementById('checkpoints-function');
            obj = JSON.parse(document.getElementById('out').value);
            obj.maxCheckpointCount = input.value;
            document.getElementById('out').value = JSON.stringify(obj, null, 4);
        });

        // document.querySelector('#function-stretched-sign input[type="submit"]').addEventListener('click', function () {
        //     var input = document.getElementById('stretched-sign-function');
        //     obj = JSON.parse(document.getElementById('out').value);
        //     // sign
        //     document.getElementById('out').value = JSON.stringify(obj, null, 4);
        // });

        document.querySelector('#function-custom-color input[type="submit"]').addEventListener('click', function () {
            var input = document.getElementById('custom-color-function');
            obj = JSON.parse(document.getElementById('out').value);
            var color = input.value.replaceAll("(", "").replaceAll(")", "").replaceAll(" ", "").split(",");
            for (let index = 0; index < 5; index++) {
                obj.levelNodes.push({
                    "levelNodeStatic": {
                        "shape": 1000+index,
                        "material": 8,
                        "position": {
                            "x": 0,
                            "y": 0,
                            "z": 0
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1,
                        },
                        "color": {
                            "r": parseInt(color[0])/255,
                            "g": parseInt(color[1])/255,
                            "b": parseInt(color[2])/255,
                            "a": 1
                        }
                    }
                });
            }
            document.getElementById('out').value = JSON.stringify(obj, null, 4);
        });


        document.getElementById("group-all").addEventListener('click', function () {
            obj = JSON.parse(document.getElementById('out').value);
            obj.levelNodes = [{
                "levelNodeGroup": {
                    "position": {
                        "y": 0, 
                        "x": 0, 
                        "z": 0
                    }, 
                    "rotation": {
                        "w": 1.0
                    }, 
                    "childNodes": obj.levelNodes, 
                    "scale": {
                        "y": 1.0, 
                        "x": 1.0, 
                        "z": 1.0
                    }
                }
            }];
            document.getElementById('out').value = JSON.stringify(obj, null, 4);
        });

        // document.getElementById("ungroup-all").addEventListener('click', function () {
            
        // });

        // document.getElementById("add-inverted").addEventListener('click', function () {
            
        // });

        document.getElementById("add-sf").addEventListener('click', function () {
            var startfinish = {
        "levelNodeGroup": {
            "position": {
                "y": 0,
                "x": 0,
                "z": 0
            },
            "rotation": {
                "w": 1
            },
            "childNodes": [
                {
                    "levelNodeGroup": {
                        "position": {
                            "x": -4,
                            "y": 2
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "childNodes": [
                            {
                                "levelNodeStart": {
                                    "position": {
                                        "x": 1,
                                        "y": 1,
                                        "z": 1
                                    },
                                    "rotation": {
                                        "w": 1
                                    },
                                    "radius": 1
                                }
                            }
                        ]
                    }
                },
                {
                    "levelNodeGroup": {
                        "position": {
                            "x": -8,
                            "y": 2
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "childNodes": [
                            {
                                "levelNodeFinish": {
                                    "position": {
                                        "x": 1,
                                        "y": 1,
                                        "z": 1
                                    },
                                    "radius": 1
                                }
                            }
                        ]
                    }
                },
                {
                    "levelNodeGroup": {
                        "position": {
                            "x": -14,
                            "y": -98
                        },
                        "scale": {
                            "x": 1,
                            "y": 100,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "childNodes": [
                            {
                                "levelNodeStart": {
                                    "position": {
                                        "x": 1,
                                        "y": 1,
                                        "z": 1
                                    },
                                    "rotation": {
                                        "w": 1
                                    },
                                    "radius": 1
                                }
                            }
                        ]
                    }
                },
                {
                    "levelNodeGroup": {
                        "position": {
                            "x": -18,
                            "y": -98
                        },
                        "scale": {
                            "x": 1,
                            "y": 100,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "childNodes": [
                            {
                                "levelNodeFinish": {
                                    "position": {
                                        "x": 1,
                                        "y": 1,
                                        "z": 1
                                    },
                                    "radius": 1
                                }
                            }
                        ]
                    }
                },
                {
                    "levelNodeGroup": {
                        "position": {
                            "x": -6,
                            "y": 2,
                            "z": -10
                        },
                        "scale": {
                            "x": 10,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "childNodes": [
                            {
                                "levelNodeStart": {
                                    "position": {
                                        "x": 1,
                                        "y": 1,
                                        "z": 1
                                    },
                                    "rotation": {
                                        "w": 1
                                    },
                                    "radius": 1
                                }
                            }
                        ]
                    }
                },
                {
                    "levelNodeGroup": {
                        "position": {
                            "x": -6,
                            "y": 2,
                            "z": -6
                        },
                        "scale": {
                            "x": 10,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "childNodes": [
                            {
                                "levelNodeFinish": {
                                    "position": {
                                        "x": 1,
                                        "y": 1,
                                        "z": 1
                                    },
                                    "radius": 1
                                }
                            }
                        ]
                    }
                }
            ],
            "scale": {
                "y": 1,
                "x": 1,
                "z": 1
            }
        }
    };
            obj = JSON.parse(document.getElementById('out').value);
            obj.levelNodes.push(startfinish);
            document.getElementById('out').value = JSON.stringify(obj, null, 4);
        });

        document.getElementById("add-crumbling").addEventListener('click', function () {
            var crumbling = {
        "levelNodeGroup": {
            "position": {
                "y": 0,
                "x": 0,
                "z": 0
            },
            "rotation": {
                "w": 1
            },
            "childNodes": [
                {
                    "levelNodeCrumbling": {
                        "shape": 1000,
                        "material": 7,
                        "position": {
                            "x": -5,
                            "y": 5,
                            "z": -4
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.1,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1000,
                        "material": 7,
                        "position": {
                            "x": -4,
                            "y": 5,
                            "z": -4
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.2,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1000,
                        "material": 7,
                        "position": {
                            "x": -3,
                            "y": 5,
                            "z": -4
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.3,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1001,
                        "material": 7,
                        "position": {
                            "x": -5,
                            "y": 5,
                            "z": -3
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.1,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1001,
                        "material": 7,
                        "position": {
                            "x": -4,
                            "y": 5,
                            "z": -3
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.2,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1001,
                        "material": 7,
                        "position": {
                            "x": -3,
                            "y": 5,
                            "z": -3
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.3,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1002,
                        "material": 7,
                        "position": {
                            "x": -5,
                            "y": 5,
                            "z": -2
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.1,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1002,
                        "material": 7,
                        "position": {
                            "x": -4,
                            "y": 5,
                            "z": -2
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.2,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1002,
                        "material": 7,
                        "position": {
                            "x": -3,
                            "y": 5,
                            "z": -2
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.3,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1003,
                        "material": 7,
                        "position": {
                            "x": -5,
                            "y": 5,
                            "z": -1
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.1,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1003,
                        "material": 7,
                        "position": {
                            "x": -4,
                            "y": 5,
                            "z": -1
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.2,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1003,
                        "material": 7,
                        "position": {
                            "x": -3,
                            "y": 5,
                            "z": -1
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.3,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1004,
                        "material": 7,
                        "position": {
                            "x": -5,
                            "y": 5
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.1,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1004,
                        "material": 7,
                        "position": {
                            "x": -4,
                            "y": 5
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.2,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1004,
                        "material": 7,
                        "position": {
                            "x": -3,
                            "y": 5
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.3,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1004,
                        "material": 7,
                        "position": {
                            "x": -2,
                            "y": 5
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.4,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1003,
                        "material": 7,
                        "position": {
                            "x": -2,
                            "y": 5,
                            "z": -1
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.4,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1002,
                        "material": 7,
                        "position": {
                            "x": -2,
                            "y": 5,
                            "z": -2
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.4,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1001,
                        "material": 7,
                        "position": {
                            "x": -2,
                            "y": 5,
                            "z": -3
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.4,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1000,
                        "material": 7,
                        "position": {
                            "x": -2,
                            "y": 5,
                            "z": -4
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.4,
                        "respawnTime": 8
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1000,
                        "material": 7,
                        "position": {
                            "x": -1,
                            "y": 5,
                            "z": -4
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 1000,
                        "respawnTime": 1000
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1001,
                        "material": 7,
                        "position": {
                            "x": -1,
                            "y": 5,
                            "z": -3
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 1000,
                        "respawnTime": 1000
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1002,
                        "material": 7,
                        "position": {
                            "x": -1,
                            "y": 5,
                            "z": -2
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 1000,
                        "respawnTime": 1000
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1003,
                        "material": 7,
                        "position": {
                            "x": -1,
                            "y": 5,
                            "z": -1
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 1000,
                        "respawnTime": 1000
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1004,
                        "material": 7,
                        "position": {
                            "x": -1,
                            "y": 5
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 1000,
                        "respawnTime": 1000
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1000,
                        "material": 7,
                        "position": {
                            "x": 0,
                            "y": 5,
                            "z": -4
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 100000,
                        "respawnTime": 100000
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1001,
                        "material": 7,
                        "position": {
                            "x": 0,
                            "y": 5,
                            "z": -3
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 100000,
                        "respawnTime": 100000
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1002,
                        "material": 7,
                        "position": {
                            "x": 0,
                            "y": 5,
                            "z": -2
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 100000,
                        "respawnTime": 100000
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1003,
                        "material": 7,
                        "position": {
                            "x": 0,
                            "y": 5,
                            "z": -1
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 100000,
                        "respawnTime": 100000
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1004,
                        "material": 7,
                        "position": {
                            "x": 0,
                            "y": 5
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 100000,
                        "respawnTime": 100000
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1000,
                        "material": 7,
                        "position": {
                            "x": 1,
                            "y": 5,
                            "z": -4
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.001,
                        "respawnTime": 0.001
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1001,
                        "material": 7,
                        "position": {
                            "x": 1,
                            "y": 5,
                            "z": -3
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.001,
                        "respawnTime": 0.001
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1002,
                        "material": 7,
                        "position": {
                            "x": 1,
                            "y": 5,
                            "z": -2
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.001,
                        "respawnTime": 0.001
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1003,
                        "material": 7,
                        "position": {
                            "x": 1,
                            "y": 5,
                            "z": -1
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.001,
                        "respawnTime": 0.001
                    }
                },
                {
                    "levelNodeCrumbling": {
                        "shape": 1004,
                        "material": 7,
                        "position": {
                            "x": 1,
                            "y": 5
                        },
                        "scale": {
                            "x": 1,
                            "y": 1,
                            "z": 1
                        },
                        "rotation": {
                            "w": 1
                        },
                        "stableTime": 0.001,
                        "respawnTime": 0.001
                    }
                }     
            ],
            "scale": {
                "y": 1,
                "x": 1,
                "z": 1
            }
        }
    };
            obj = JSON.parse(document.getElementById('out').value);
            obj.levelNodes.push(crumbling);
            document.getElementById('out').value = JSON.stringify(obj, null, 4);
        });

        document.getElementById("add-colors").addEventListener('click', function () {
            var colors = {
                "levelNodeGroup": {
                    "position": {
                        "y": 0,
                        "x": 0,
                        "z": 0
                    },
                    "rotation": {
                        "w": 1
                    },
                    "childNodes": [
                        {
                            "levelNodeStatic": {
                                "shape": 1000,
                                "material": 8,
                                "position": {
                                    "x": -4,
                                    "y": 4,
                                    "z": -3
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {},
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1001,
                                "material": 8,
                                "position": {
                                    "x": -2,
                                    "y": 4,
                                    "z": -3
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {},
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1002,
                                "material": 8,
                                "position": {
                                    "x": 0,
                                    "y": 4,
                                    "z": -3
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {},
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1003,
                                "material": 8,
                                "position": {
                                    "x": 4,
                                    "y": 4,
                                    "z": -3
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {},
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1004,
                                "material": 8,
                                "position": {
                                    "x": 2,
                                    "y": 4,
                                    "z": -3
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {},
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1000,
                                "material": 8,
                                "position": {
                                    "x": -4,
                                    "y": 4,
                                    "z": -1
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "r": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1001,
                                "material": 8,
                                "position": {
                                    "x": -2,
                                    "y": 4,
                                    "z": -1
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "r": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1002,
                                "material": 8,
                                "position": {
                                    "x": 0,
                                    "y": 4,
                                    "z": -1
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "r": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1003,
                                "material": 8,
                                "position": {
                                    "x": 4,
                                    "y": 4,
                                    "z": -1
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "r": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1004,
                                "material": 8,
                                "position": {
                                    "x": 2,
                                    "y": 4,
                                    "z": -1
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "r": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1000,
                                "material": 8,
                                "position": {
                                    "x": -4,
                                    "y": 4,
                                    "z": 1
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "g": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1001,
                                "material": 8,
                                "position": {
                                    "x": -2,
                                    "y": 4,
                                    "z": 1
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "g": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1002,
                                "material": 8,
                                "position": {
                                    "x": 0,
                                    "y": 4,
                                    "z": 1
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "g": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1003,
                                "material": 8,
                                "position": {
                                    "x": 4,
                                    "y": 4,
                                    "z": 1
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "g": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1004,
                                "material": 8,
                                "position": {
                                    "x": 2,
                                    "y": 4,
                                    "z": 1
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "g": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1000,
                                "material": 8,
                                "position": {
                                    "x": -4,
                                    "y": 4,
                                    "z": 3
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "b": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1001,
                                "material": 8,
                                "position": {
                                    "x": -2,
                                    "y": 4,
                                    "z": 3
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "b": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1002,
                                "material": 8,
                                "position": {
                                    "x": 0,
                                    "y": 4,
                                    "z": 3
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "b": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1003,
                                "material": 8,
                                "position": {
                                    "x": 4,
                                    "y": 4,
                                    "z": 3
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "b": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1004,
                                "material": 8,
                                "position": {
                                    "x": 2,
                                    "y": 4,
                                    "z": 3
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "b": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1000,
                                "material": 8,
                                "position": {
                                    "x": -4,
                                    "y": 4,
                                    "z": 5
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "r": 1,
                                    "g": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1001,
                                "material": 8,
                                "position": {
                                    "x": -2,
                                    "y": 4,
                                    "z": 5
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "r": 1,
                                    "g": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1002,
                                "material": 8,
                                "position": {
                                    "x": 0,
                                    "y": 4,
                                    "z": 5
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "r": 1,
                                    "g": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1003,
                                "material": 8,
                                "position": {
                                    "x": 4,
                                    "y": 4,
                                    "z": 5
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "r": 1,
                                    "g": 1
                                },
                                "isNeon": true
                            }
                        },
                        {
                            "levelNodeStatic": {
                                "shape": 1004,
                                "material": 8,
                                "position": {
                                    "x": 2,
                                    "y": 4,
                                    "z": 5
                                },
                                "scale": {
                                    "x": 1,
                                    "y": 1,
                                    "z": 1
                                },
                                "rotation": {
                                    "w": 1
                                },
                                "color": {
                                    "r": 1,
                                    "g": 1
                                },
                                "isNeon": true
                            }
                        }
                    ],
                    "scale": {
                        "y": 1,
                        "x": 1,
                        "z": 1
                    }
                }
            };
            obj = JSON.parse(document.getElementById('out').value);
            obj.levelNodes.push(colors);
            document.getElementById('out').value = JSON.stringify(obj, null, 4);
        });

        document.getElementById("clear-info").addEventListener('click', function () {
            obj = JSON.parse(document.getElementById('out').value);
            obj.title = "";
            obj.description = "";
            obj.creators = "";
            document.getElementById('out').value = JSON.stringify(obj, null, 4);
        });

        document.getElementById("reset-ambience").addEventListener('click', function () {
            obj = JSON.parse(document.getElementById('out').value);
            obj.ambienceSettings = {
                        "skyZenithColor": {
                            "r": 0,
                            "g": 0,
                            "b": 0,
                            "a": 1
                        },
                        "skyHorizonColor": {
                            "r": 0,
                            "g": 0,
                            "b": 0,
                            "a": 1
                        },
                        "sunAltitude": 0,
                        "sunAzimuth": 0,
                        "sunSize": 1,
                        "fogDDensity": 0
                    };
            document.getElementById('out').value = JSON.stringify(obj, null, 4);
        });

        document.getElementById("max-ambience").addEventListener('click', function () {
            obj = JSON.parse(document.getElementById('out').value);
            obj.ambienceSettings = {
                        "skyZenithColor": {
                            "r": 32000,
                            "g": 32000,
                            "b": 32000,
                            "a": 1
                        },
                        "skyHorizonColor": {
                            "r": 32000,
                            "g": 32000,
                            "b": 32000,
                            "a": 1
                        },
                        "sunAltitude": 32000,
                        "sunAzimuth": 32000,
                        "sunSize": 32000,
                        "fogDDensity": 32000
                    };
            document.getElementById('out').value = JSON.stringify(obj, null, 4);
        });
        document.getElementById("randomize").addEventListener('click', function () { // terrible
            obj = JSON.parse(document.getElementById('out').value);
            obj.levelNodes.forEach(node => {
                if (node.levelNodeStatic) {
                    node.levelNodeStatic.position.x ? node.levelNodeStatic.position.x *= (Math.random()-.5)*4 : node.levelNodeStatic.position.x = (Math.random()-.5)*4;
                    node.levelNodeStatic.position.y ? node.levelNodeStatic.position.y *= (Math.random()-.5)*4 : node.levelNodeStatic.position.y = (Math.random()-.5)*4;
                    node.levelNodeStatic.position.z ? node.levelNodeStatic.position.z *= (Math.random()-.5)*4 : node.levelNodeStatic.position.z = (Math.random()-.5)*4;
                } else if (node.levelNodeCrumbling) {
                    node.levelNodeCrumbling.position.x ? node.levelNodeCrumbling.position.x *= (Math.random()-.5)*4 : node.levelNodeCrumbling.position.x = (Math.random()-.5)*4;
                    node.levelNodeCrumbling.position.y ? node.levelNodeCrumbling.position.y *= (Math.random()-.5)*4 : node.levelNodeCrumbling.position.y = (Math.random()-.5)*4;
                    node.levelNodeCrumbling.position.z ? node.levelNodeCrumbling.position.z *= (Math.random()-.5)*4 : node.levelNodeCrumbling.position.z = (Math.random()-.5)*4;
                } else if (node.levelNodeGroup) {
                    node.levelNodeGroup.childNodes.forEach(cNode => {
                        if (cNode.levelNodeStatic) {
                            cNode.levelNodeStatic.position.x ? cNode.levelNodeStatic.position.x *= (Math.random()-.5)*4 : cNode.levelNodeStatic.position.x = (Math.random()-.5)*4;
                            cNode.levelNodeStatic.position.y ? cNode.levelNodeStatic.position.y *= (Math.random()-.5)*4 : cNode.levelNodeStatic.position.y = (Math.random()-.5)*4;
                            cNode.levelNodeStatic.position.z ? cNode.levelNodeStatic.position.z *= (Math.random()-.5)*4 : cNode.levelNodeStatic.position.z = (Math.random()-.5)*4;
                        } else if (cNode.levelNodeCrumbling) {
                            cNode.levelNodeCrumbling.position.x ? cNode.levelNodeCrumbling.position.x *= (Math.random()-.5)*4 : cNode.levelNodeCrumbling.position.x = (Math.random()-.5)*4;
                            cNode.levelNodeCrumbling.position.y ? cNode.levelNodeCrumbling.position.y *= (Math.random()-.5)*4 : cNode.levelNodeCrumbling.position.y = (Math.random()-.5)*4;
                            cNode.levelNodeCrumbling.position.z ? cNode.levelNodeCrumbling.position.z *= (Math.random()-.5)*4 : cNode.levelNodeCrumbling.position.z = (Math.random()-.5)*4;
                        }
                    });
                }
            });
            document.getElementById('out').value = JSON.stringify(obj, null, 4);
        });
        document.getElementById("duplicate").addEventListener('click', function () {
            obj = JSON.parse(document.getElementById('out').value);
            obj.levelNodes = obj.levelNodes.concat(obj.levelNodes);
            document.getElementById('out').value = JSON.stringify(obj, null, 4);
        });
        document.getElementById("parallelograms").addEventListener('click', function () {
            var parallelograms = {
            "levelNodeGroup": {
                "position": {
                    "y": 0,
                    "x": 0,
                    "z": 0
                },
                "rotation": {
                    "w": 1
                },
                "childNodes": [
                    {
                        "levelNodeGroup": {
                            "position": {
                                "y": 0,
                                "x": 0,
                                "z": 0
                            },
                            "rotation": {
                                "w": 1
                            },
                            "childNodes": [
                                {
                                    "levelNodeGroup": {
                                        "position": {
                                            "y": 0,
                                            "x": 0,
                                            "z": 0
                                        },
                                        "rotation": {
                                            "w": 1
                                        },
                                        "childNodes": [
                                            {
                                                "levelNodeStatic": {
                                                    "shape": 1000,
                                                    "material": 0,
                                                    "position": {
                                                        "x": 0,
                                                        "y": 0,
                                                        "z": 0
                                                    },
                                                    "scale": {
                                                        "x": 2,
                                                        "y": 1,
                                                        "z": 1
                                                    },
                                                    "rotation": {
                                                        "w": 0.924,
                                                        "x": 0,
                                                        "y": 0.383,
                                                        "z": 0
                                                    }
                                                }
                                            }
                                        ],
                                        "scale": {
                                            "y": 1,
                                            "x": 1,
                                            "z": 4
                                        }
                                    }
                                }
                            ],
                            "scale": {
                                "y": 1,
                                "x": 1,
                                "z": 0.5
                            }
                        }
                    },
                    {
                        "levelNodeGroup": {
                            "position": {
                                "y": 0,
                                "x": 0,
                                "z": 0
                            },
                            "rotation": {
                                "w": 1
                            },
                            "childNodes": [
                                {
                                    "levelNodeGroup": {
                                        "position": {
                                            "y": 0,
                                            "x": 0,
                                            "z": 0
                                        },
                                        "rotation": {
                                            "w": 1
                                        },
                                        "childNodes": [
                                            {
                                                "levelNodeCrumbling": {
                                                    "shape": 1000,
                                                    "material": 7,
                                                    "position": {
                                                        "x": 2,
                                                        "y": 0,
                                                        "z": 0
                                                    },
                                                    "scale": {
                                                        "x": 2,
                                                        "y": 1,
                                                        "z": 1
                                                    },
                                                    "rotation": {
                                                        "w": 0.924,
                                                        "x": 0,
                                                        "y": 0.383,
                                                        "z": 0
                                                    },
                                                    "stableTime": 0.5,
                                                    "respawnTime": 0.5
                                                }
                                            }
                                        ],
                                        "scale": {
                                            "y": 1,
                                            "x": 1,
                                            "z": 4
                                        }
                                    }
                                }
                            ],
                            "scale": {
                                "y": 1,
                                "x": 1,
                                "z": 0.5
                            }
                        }
                    },
                    {
                        "levelNodeGroup": {
                            "position": {
                                "y": 0,
                                "x": 0,
                                "z": 0
                            },
                            "rotation": {
                                "w": 1
                            },
                            "childNodes": [
                                {
                                    "levelNodeGroup": {
                                        "position": {
                                            "y": 0,
                                            "x": 0,
                                            "z": 0
                                        },
                                        "rotation": {
                                            "w": 1
                                        },
                                        "childNodes": [
                                            {
                                                "levelNodeStatic": {
                                                    "shape": 1000,
                                                    "material": 9,
                                                    "position": {
                                                        "x": 4,
                                                        "y": 0,
                                                        "z": 0
                                                    },
                                                    "scale": {
                                                        "x": 2,
                                                        "y": 1,
                                                        "z": 1
                                                    },
                                                    "rotation": {
                                                        "w": 0.924,
                                                        "x": 0,
                                                        "y": 0.383,
                                                        "z": 0
                                                    }
                                                }
                                            }
                                        ],
                                        "scale": {
                                            "y": 1,
                                            "x": 1,
                                            "z": 4
                                        }
                                    }
                                }
                            ],
                            "scale": {
                                "y": 1,
                                "x": 1,
                                "z": 0.5
                            }
                        }
                    },
                    {
                        "levelNodeGroup": {
                            "position": {
                                "y": 0,
                                "x": 0,
                                "z": 0
                            },
                            "rotation": {
                                "w": 1
                            },
                            "childNodes": [
                                {
                                    "levelNodeGroup": {
                                        "position": {
                                            "y": 0,
                                            "x": 0,
                                            "z": 0
                                        },
                                        "rotation": {
                                            "w": 1
                                        },
                                        "childNodes": [
                                            {
                                                "levelNodeStatic": {
                                                    "shape": 1000,
                                                    "material": 8,
                                                    "position": {
                                                        "x": 6,
                                                        "y": 0,
                                                        "z": 0
                                                    },
                                                    "scale": {
                                                        "x": 2,
                                                        "y": 1,
                                                        "z": 1
                                                    },
                                                    "rotation": {
                                                        "w": 0.924,
                                                        "x": 0,
                                                        "y": 0.383,
                                                        "z": 0
                                                    },
                                                    "color": {
                                                        "r": 0,
                                                        "g": 1,
                                                        "b": 1,
                                                        "a": 1
                                                    }
                                                }
                                            }
                                        ],
                                        "scale": {
                                            "y": 1,
                                            "x": 1,
                                            "z": 4
                                        }
                                    }
                                }
                            ],
                            "scale": {
                                "y": 1,
                                "x": 1,
                                "z": 0.5
                            }
                        }
                    },
                    {
                        "levelNodeGroup": {
                            "position": {
                                "y": 0,
                                "x": 0,
                                "z": 0
                            },
                            "rotation": {
                                "w": 1
                            },
                            "childNodes": [
                                {
                                    "levelNodeGroup": {
                                        "position": {
                                            "y": 0,
                                            "x": 0,
                                            "z": 0
                                        },
                                        "rotation": {
                                            "w": 1
                                        },
                                        "childNodes": [
                                            {
                                                "levelNodeStatic": {
                                                    "shape": 1000,
                                                    "material": 6,
                                                    "position": {
                                                        "x": 8,
                                                        "y": 0,
                                                        "z": 0
                                                    },
                                                    "scale": {
                                                        "x": 2,
                                                        "y": 1,
                                                        "z": 1
                                                    },
                                                    "rotation": {
                                                        "w": 0.924,
                                                        "x": 0,
                                                        "y": 0.383,
                                                        "z": 0
                                                    }
                                                }
                                            }
                                        ],
                                        "scale": {
                                            "y": 1,
                                            "x": 1,
                                            "z": 4
                                        }
                                    }
                                }
                            ],
                            "scale": {
                                "y": 1,
                                "x": 1,
                                "z": 0.5
                            }
                        }
                    },
                    {
                        "levelNodeGroup": {
                            "position": {
                                "y": 0,
                                "x": 0,
                                "z": 0
                            },
                            "rotation": {
                                "w": 1
                            },
                            "childNodes": [
                                {
                                    "levelNodeGroup": {
                                        "position": {
                                            "y": 0,
                                            "x": 0,
                                            "z": 0
                                        },
                                        "rotation": {
                                            "w": 1
                                        },
                                        "childNodes": [
                                            {
                                                "levelNodeStatic": {
                                                    "shape": 1000,
                                                    "material": 5,
                                                    "position": {
                                                        "x": 10,
                                                        "y": 0,
                                                        "z": 0
                                                    },
                                                    "scale": {
                                                        "x": 2,
                                                        "y": 1,
                                                        "z": 1
                                                    },
                                                    "rotation": {
                                                        "w": 0.924,
                                                        "x": 0,
                                                        "y": 0.383,
                                                        "z": 0
                                                    }
                                                }
                                            }
                                        ],
                                        "scale": {
                                            "y": 1,
                                            "x": 1,
                                            "z": 4
                                        }
                                    }
                                }
                            ],
                            "scale": {
                                "y": 1,
                                "x": 1,
                                "z": 0.5
                            }
                        }
                    },
                    {
                        "levelNodeGroup": {
                            "position": {
                                "y": 0,
                                "x": 0,
                                "z": 0
                            },
                            "rotation": {
                                "w": 1
                            },
                            "childNodes": [
                                {
                                    "levelNodeGroup": {
                                        "position": {
                                            "y": 0,
                                            "x": 0,
                                            "z": 0
                                        },
                                        "rotation": {
                                            "w": 1
                                        },
                                        "childNodes": [
                                            {
                                                "levelNodeStatic": {
                                                    "shape": 1000,
                                                    "material": 4,
                                                    "position": {
                                                        "x": 12,
                                                        "y": 0,
                                                        "z": 0
                                                    },
                                                    "scale": {
                                                        "x": 2,
                                                        "y": 1,
                                                        "z": 1
                                                    },
                                                    "rotation": {
                                                        "w": 0.924,
                                                        "x": 0,
                                                        "y": 0.383,
                                                        "z": 0
                                                    }
                                                }
                                            }
                                        ],
                                        "scale": {
                                            "y": 1,
                                            "x": 1,
                                            "z": 4
                                        }
                                    }
                                }
                            ],
                            "scale": {
                                "y": 1,
                                "x": 1,
                                "z": 0.5
                            }
                        }
                    },
                    {
                        "levelNodeGroup": {
                            "position": {
                                "y": 0,
                                "x": 0,
                                "z": 0
                            },
                            "rotation": {
                                "w": 1
                            },
                            "childNodes": [
                                {
                                    "levelNodeGroup": {
                                        "position": {
                                            "y": 0,
                                            "x": 0,
                                            "z": 0
                                        },
                                        "rotation": {
                                            "w": 1
                                        },
                                        "childNodes": [
                                            {
                                                "levelNodeStatic": {
                                                    "shape": 1000,
                                                    "material": 3,
                                                    "position": {
                                                        "x": 14,
                                                        "y": 0,
                                                        "z": 0
                                                    },
                                                    "scale": {
                                                        "x": 2,
                                                        "y": 1,
                                                        "z": 1
                                                    },
                                                    "rotation": {
                                                        "w": 0.924,
                                                        "x": 0,
                                                        "y": 0.383,
                                                        "z": 0
                                                    }
                                                }
                                            }
                                        ],
                                        "scale": {
                                            "y": 1,
                                            "x": 1,
                                            "z": 4
                                        }
                                    }
                                }
                            ],
                            "scale": {
                                "y": 1,
                                "x": 1,
                                "z": 0.5
                            }
                        }
                    },
                    {
                        "levelNodeGroup": {
                            "position": {
                                "y": 0,
                                "x": 0,
                                "z": 0
                            },
                            "rotation": {
                                "w": 1
                            },
                            "childNodes": [
                                {
                                    "levelNodeGroup": {
                                        "position": {
                                            "y": 0,
                                            "x": 0,
                                            "z": 0
                                        },
                                        "rotation": {
                                            "w": 1
                                        },
                                        "childNodes": [
                                            {
                                                "levelNodeStatic": {
                                                    "shape": 1000,
                                                    "material": 2,
                                                    "position": {
                                                        "x": 16,
                                                        "y": 0,
                                                        "z": 0
                                                    },
                                                    "scale": {
                                                        "x": 2,
                                                        "y": 1,
                                                        "z": 1
                                                    },
                                                    "rotation": {
                                                        "w": 0.924,
                                                        "x": 0,
                                                        "y": 0.383,
                                                        "z": 0
                                                    }
                                                }
                                            }
                                        ],
                                        "scale": {
                                            "y": 1,
                                            "x": 1,
                                            "z": 4
                                        }
                                    }
                                }
                            ],
                            "scale": {
                                "y": 1,
                                "x": 1,
                                "z": 0.5
                            }
                        }
                    },
                    {
                        "levelNodeGroup": {
                            "position": {
                                "y": 0,
                                "x": 0,
                                "z": 0
                            },
                            "rotation": {
                                "w": 1
                            },
                            "childNodes": [
                                {
                                    "levelNodeGroup": {
                                        "position": {
                                            "y": 0,
                                            "x": 0,
                                            "z": 0
                                        },
                                        "rotation": {
                                            "w": 1
                                        },
                                        "childNodes": [
                                            {
                                                "levelNodeStatic": {
                                                    "shape": 1000,
                                                    "material": 1,
                                                    "position": {
                                                        "x": 18,
                                                        "y": 0,
                                                        "z": 0
                                                    },
                                                    "scale": {
                                                        "x": 2,
                                                        "y": 1,
                                                        "z": 1
                                                    },
                                                    "rotation": {
                                                        "w": 0.924,
                                                        "x": 0,
                                                        "y": 0.383,
                                                        "z": 0
                                                    }
                                                }
                                            }
                                        ],
                                        "scale": {
                                            "y": 1,
                                            "x": 1,
                                            "z": 4
                                        }
                                    }
                                }
                            ],
                            "scale": {
                                "y": 1,
                                "x": 1,
                                "z": 0.5
                            }
                        }
                    }
                ],
                "scale": {
                    "y": 1,
                    "x": 1,
                    "z": 1
                }
            }
        };
            obj = JSON.parse(document.getElementById('out').value);
            obj.levelNodes.push(parallelograms);
            document.getElementById('out').value = JSON.stringify(obj, null, 4);
        });
        document.getElementById("load-empty").addEventListener('click', function () {
            obj = {
                    "formatVersion": 6,
                    "title": "",
                    "creators": "",
                    "description": "",
                    "levelNodes": [],
                    "maxCheckpointCount": 0,
                    "ambienceSettings": {
                        "skyZenithColor": {
                            "r": 0,
                            "g": 0,
                            "b": 0,
                            "a": 1
                        },
                        "skyHorizonColor": {
                            "r": 0,
                            "g": 0,
                            "b": 0,
                            "a": 1
                        },
                        "sunAltitude": 0,
                        "sunAzimuth": 0,
                        "sunSize": 1,
                        "fogDDensity": 0
                    }
                }
                document.getElementById('out').value = JSON.stringify(obj, null, 4);
        });
        document.getElementById("add-template").addEventListener('click', function () {
            obj = JSON.parse(document.getElementById('out').value);
            let appending = JSON.parse(document.getElementById('template').value);
            obj.levelNodes.push(appending);
            document.getElementById('out').value = JSON.stringify(obj, null, 4);
        });
        document.getElementById("temp-static").addEventListener('click', function () {
            let obj = {
                "levelNodeStatic": {
                    "shape": 1000,
                    "material": 0,
                    "position": {
                        "x": 0,
                        "y": 0,
                        "z": 0
                    },
                    "scale": {
                        "x": 1,
                        "y": 1,
                        "z": 1
                    },
                    "rotation": {
                        "w": 1,
                        "x": 0,
                        "y": 0,
                        "z": 0
                    }
                }
            }
            document.getElementById('template').value = JSON.stringify(obj, null, 4);
        });
        document.getElementById("temp-crumbling").addEventListener('click', function () {
            let obj = {
                "levelNodeCrumbling": {
                    "shape": 1000,
                    "material": 7,
                    "position": {
                        "x": 0,
                        "y": 0,
                        "z": 0
                    },
                    "scale": {
                        "x": 1,
                        "y": 1,
                        "z": 1
                    },
                    "rotation": {
                        "w": 1,
                        "x": 0,
                        "y": 0,
                        "z": 0
                    },
                    "stableTime": 0.5,
                    "respawnTime": 0.5
                }
            }
            document.getElementById('template').value = JSON.stringify(obj, null, 4);
        });
        document.getElementById("temp-colored").addEventListener('click', function () {
            let obj = {
                "levelNodeStatic": {
                    "shape": 1000,
                    "material": 8,
                    "position": {
                        "x": 0,
                        "y": 0,
                        "z": 0
                    },
                    "scale": {
                        "x": 1,
                        "y": 1,
                        "z": 1
                    },
                    "rotation": {
                        "w": 1,
                        "x": 0,
                        "y": 0,
                        "z": 0
                    },
                    "color": {
                        "r": 1,
                        "g": 1,
                        "b": 1,
                        "a": 1
                    },
                    "isNeon": false
                }
            }
            document.getElementById('template').value = JSON.stringify(obj, null, 4);
        });
        document.getElementById("temp-sign").addEventListener('click', function () {
            let obj = {
                "levelNodeSign": {
                    "position": {
                        "x": 0,
                        "y": 0,
                        "z": 0
                    },
                    "rotation": {
                        "w": 1,
                        "x": 0,
                        "y": 0,
                        "z": 0
                    },
                    "text": "Sample text"
                }
            }
            document.getElementById('template').value = JSON.stringify(obj, null, 4);
        });
        document.getElementById("temp-start").addEventListener('click', function () {
            let obj = {
                "levelNodeStart": {
                    "position": {
                        "x": 0,
                        "y": 0,
                        "z": 0
                    },
                    "rotation": {
                        "w": 1,
                        "x": 0,
                        "y": 0,
                        "z": 0
                    },
                    "radius": 1
                }
            }
            document.getElementById('template').value = JSON.stringify(obj, null, 4);
        });
        document.getElementById("temp-finish").addEventListener('click', function () {
            let obj = {
                "levelNodeFinish": {
                    "position": {
                        "x": 0,
                        "y": 0,
                        "z": 0
                    },
                    "radius": 1
                }
            }
            document.getElementById('template').value = JSON.stringify(obj, null, 4);
        });
        document.getElementById('file').addEventListener("change", function (e) {loadFile(e)}, false);
        document.getElementById('file-a').addEventListener("change", function (e) {loadFile(e, true)}, false);
        document.getElementById('file-append').addEventListener("change", function (e) {appendFile(e)}, false);
        document.getElementById('out').value = JSON.stringify({
                        "formatVersion": 6,
                        "title": "",
                        "creators": "",
                        "description": "",
                        "levelNodes": [],
                        "maxCheckpointCount": 0,
                        "ambienceSettings": {
                            "skyZenithColor": {
                                "r": 0,
                                "g": 0,
                                "b": 0,
                                "a": 1
                            },
                            "skyHorizonColor": {
                                "r": 0,
                                "g": 0,
                                "b": 0,
                                "a": 1
                            },
                            "sunAltitude": 0,
                            "sunAzimuth": 0,
                            "sunSize": 1,
                            "fogDDensity": 0
                        }
                    }, null, 4);
        document.getElementById('out').style.display = "block";
        document.getElementsByClassName('leg')[0].style.display = "flex";
    
        let cArr = [
            [0, 0, 0],
            [255, 0, 0],
            [0, 255, 0],
            [0, 0, 255],
            [0, 255, 255],
            [255, 0, 255],
            [255, 255, 0],
            [200, 0, 0],
            [0, 200, 0],
            [0, 0, 200],
            [0, 200, 200],
            [200, 0, 200],
            [200, 200, 0],
            [127.5, 0, 0],
            [0, 127.5, 0],
            [0, 0, 127.5],
            [0, 127.5, 127.5],
            [127.5, 0, 127.5],
            [127.5, 127.5, 0],
            [100, 0, 0],
            [0, 100, 0],
            [0, 0, 100],
            [0, 100, 100],
            [100, 0, 100],
            [100, 100, 0],
            [50, 0, 0],
            [0, 50, 0],
            [0, 0, 50],
            [0, 50, 50],
            [50, 0, 50],
            [50, 50, 0],
            [-255, -255, -255],
            [255, -255, -255],
            [-255, 255, -255],
            [-255, -255, 255],
            [-255, 255, 255],
            [255, -255, 255],
            [255, 255, -255]
        ];
        function addColorArray(arr) {
            var cNodes = [];
            for (let i = 0; i < arr.length; i++) {
                const el = arr[i];
                for (let j = 0; j < 5; j++) {
                    cNode = {
                        "levelNodeStatic": {
                            "shape": 1000 + j,
                            "material": 8,
                            "position": {
                                "x": j,
                                "y": 0,
                                "z": i
                            },
                            "scale": {
                                "x": 1,
                                "y": 1,
                                "z": 1
                            },
                            "rotation": {
                                "w": 1,
                                "x": 0,
                                "y": 0,
                                "z": 0
                            },
                            "color": {
                                "r": el[0]/255,
                                "g": el[1]/255,
                                "b": el[2]/255,
                                "a": 1
                            },
                            "isNeon": true
                        }
                    }
                    cNodes.push(cNode);
                }
            }
            obj = JSON.parse(document.getElementById('out').value);
            obj.levelNodes = cNodes;
            document.getElementById('out').value = JSON.stringify(obj, null, 4);
        }
    </script>
    <script src="visual-editor.js" type="module"></script>
</body>
</html>
